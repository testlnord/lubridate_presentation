Здраствуйте, меня зовут Аркадий. Я занимаюсь аналитикой в отделе маркетинговых исследований тут в JetBrains 
Сегодня я буду рассказывать вам про Lubridate. Это пакет для работы с датами и временем. Создан он при участии известного, я думаю многим, Хадли Викхема.

Сам по себе этот пакет не обязателен. Все что можно сделать с его помощью можно сделать и без него. Но с ним это проще, и более приятно.

Я расскажу вам три истории в которых lubridate помог мне или кому-то из моих коллег.
Я буду использовать dplyr в своих примерах. Код простой и все должно быть понятно, но если будут какие-то вопросы к коду, то спрашивайте сразу. 

История первая. Про актинвых пользователей.

У нас есть данные о каких-то пользовательских активностях. Главное в них это идентификаторы пользователей и даты, когда они что-то делали. Активности эти редкие, пользователи могут делать что-то раз в пару месяцев, поэтому 
решили считать пользователя активным с момента первой активности и в течение года после последней активности. 
Нужно построить график количества активных пользователей по месяцам.

Для начала мы  получили для каждого пользователя время первой и последней активности. 
Теперь нужно получить месяц активности. Т.е. дату первого числа того месяца, когда активность произошла. Я когда этим занимался сначала поискал в интернете 
как это люди делают. Вот первое решение которое я нашел, на чистом R.
Я когда это увидел меня немного перекосило. 
По-хорошему мне нужно только день изменить у даты, а мне для этого предлагают конвертировать все в строку, а потом снова эту строку парсить.
Я поискал еще немного и узнал про lubridate. 
Вот этот код короче, приятнее, понятнее и быстрее. 
Это был такой мотивационный пример, на тему того что можно конечно и без lubridate но с ним приятнее.

Так, даты мы округлили. Теперь нужно прибавить год к месяцу последней активности. Кто знает как можно в голом R прибавить к дате год?
А вот как это делается в lubridat 
Вот этот код короче, приятнее, понятнее и быстрее. 
Это был такой мотивационный пример, на тему того что можно конечно и без lubridate но с ним приятнее.

Так, даты мы округлили. Теперь нужно прибавить год к месяцу последней активности. Кто знает как можно в голом R прибавить к дате год?
А вот как это делается в lubridate. Опять довольно просто и понятно

Что еще можно прибавить к дате? Вот несколько функций, из названий которых понятно что они делают. Объект который они возвращают называется Period. Их можно умножать на число, складывать друг с другом и с датами. 
Периоды относительны. Прибавление years изменяет только год, даже если год високосный. А что тогда получится в результате выполенения этого кода?

Получаются невалидные даты. Поэтому в качестве результата возвращаются NA.
Но что если мы не это имели в виду? Ну хотим мы месяц прибавить к 31 января. Ну понятно это конец месяца, мы должны получить конец следующего месяца. Для этого
есть операторы с префиксом `m`. Если в результате должна получится какая-то невалидная дата, то они возвращают предыдущую валидную. 

Ну и в итоге мы получили вот такую картинку: 

Вторая история. Про плохую выгрузку.
Я выгружал данные из разных источников и писал их в одну csv. Из-за того что там были разные форматы, а я забыл это проверить то в результате получилась вот такая каша из форматов.

В принципе меня интересовали только даты, так что я мог бы взять первые 12 символов и сконвертировать, но во-первых я уже на тот момент прочитал help к lubridate
